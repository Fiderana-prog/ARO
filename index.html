<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aro - Trajet SÃ»r</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

    <!-- Police -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap"
        rel="stylesheet" />

    <!-- Variables & font -->
    <style type="text/tailwindcss">
        :root{
      --safe-green:#42FF1C;
      --danger-red:#ef4444;
      --light-gray:#f9fafb;
      --medium-gray:#e5e7eb;
      --dark-gray:#4b5563;
      --text-color:#111827;
      --primary-blue:#3b82f6;
      --white:#ffffff;
    }
    body{font-family:"Plus Jakarta Sans",sans-serif;}
  </style>
    <script type="module" src="https://unpkg.com/@googlemaps/extended-component-library">
    </script>
</head>

<body class="bg-light-gray ">
    <!-- Loader Overlay -->
    <div id="initialLoader" class="fixed inset-0 flex flex-col items-center justify-center bg-white z-50 space-y-4">
        <img src="logo.png" alt="Logo Aro" class="h-16 animate-pulse" />
        <svg class="animate-spin h-10 w-10 text-primary-blue" xmlns="http://www.w3.org/2000/svg" fill="none"
            viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8H4z"></path>
        </svg>
    </div>

    <div class="flex flex-col max-w-md mx-auto bg-white">

        <!-- Header dynamique -->
        <header id="appHeader"
            class="fixed top-0 left-0 w-full z-50 p-4 flex items-center justify-between border-b border-medium-gray bg-white">
            <div></div><!-- placeholder gauche -->

            <a href="/" class="block">
                <img src="logo.png" alt="Logo" class="h-8">
            </a>

            <div></div><!-- placeholder droite -->
        </header>


        <!-- Contenu -->
        <main class="flex-grow overflow-y-auto bg-gray-50">
            <!-- SECTION : ACCUEIL -->
            <section id="sectionHome"
                class="flex flex-col items-center justify-center h-[calc(100vh-100px)] overflow-y-auto px-6 space-y-6 mb-32 mt-16">

                <!-- Bouton rond XL centrÃ© avec animation -->
                <div class="flex justify-center">
                    <button id="toggleTracking" class="w-36 h-36 rounded-full flex items-center justify-center relative
    text-white text-xl font-semibold transition-all duration-300
    bg-black hover:brightness-105 active:scale-95 shadow-lg">


                        <!-- Texte -->
                        <span id="toggleText" class="z-10">Activer</span>

                        <!-- Spinner centrÃ© -->
                        <svg id="toggleSpinner" class="animate-spin h-8 w-8 text-white absolute z-10 hidden"
                            xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4">
                            </circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8H4z"></path>
                        </svg>
                    </button>


                </div>

                <div id="mapContainer" class="mt-4">
                    <!-- iframe sera injectÃ© dynamiquement ici -->
                </div>


                <!-- Loader -->
                <div id="loader" class="flex justify-center hidden">
                    <svg class="animate-spin h-10 w-10 text-primary-blue" xmlns="http://www.w3.org/2000/svg" fill="none"
                        viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4">
                        </circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8H4z" />
                    </svg>
                </div>

                <!-- Statut -->
                <p id="trackingStatus" class="text-center text-xl text-sm text-dark-gray">
                    Tracking dÃ©sactivÃ©
                </p>

                <!-- Localisation -->
                <div class="text-center space-y-1">
                    <h3 class="text-sm font-medium text-gray-700">Votre position actuelle</h3>
                    <p id="userLocation" class="text-sm text-blue-600 underline hover:text-blue-800 transition-colors">
                        Localisation non dÃ©tectÃ©e
                    </p>
                </div>
                <div id="nearestZones" class="w-full max-w-sm bg-red-50 p-4 rounded-xl border border-red-200">
                    <h4 class="text-red-600 font-semibold mb-2">ðŸš¨ Zones Ã  risque proches</h4>
                    <ul id="nearestZonesList" class="list-disc list-inside text-red-700 space-y-1 text-sm">
                        <li>Calcul en coursâ€¦</li>
                    </ul>
                </div>

            </section>
            <!-- SECTION : CARTE (cachÃ©) -->


            <!-- SECTION : MAP / TRAJET -->
            <section id="sectionMap"
                class="flex flex-col items-center justify-center h-[calc(100vh-100px)] overflow-y-auto px-6 space-y-6 mb-28 mt-16">
                <h2 class="text-xl font-semibold mt-16">Planifiez votre trajet</h2>

                <div class="bg-white p-5 rounded-2xl shadow space-y-4">
                    <input id="originInput" placeholder="Lieu de dÃ©part"
                        class="w-full h-12 rounded-lg border border-gray-300 px-3 focus:ring-2 focus:ring-primary-blue outline-none" />

                    <input id="destInput" placeholder="Lieu dâ€™arrivÃ©e"
                        class="w-full h-12 rounded-lg border border-gray-300 px-3 focus:ring-2 focus:ring-primary-blue outline-none" />

                    <!-- âœ… PremiÃ¨re photo affichÃ©e -->
                    <img id="routeImage" src="trajet danger.png" alt="Trajet dangereux"
                        class="w-full max-h-61 -pt-5 object-cover rounded-lg" />

                    <!-- âœ… Bouton bien visible -->
                    <button id="showRoute"
                        class="w-[150px] bg-[#42FF1C] text-black py-3 rounded-lg font-large hover:brightness-105 active:scale-95 transition allign-items-center mx-auto flex justify-center gap-2">
                        Afficher lâ€™itinÃ©raire
                    </button>
                </div>

    </div>


    </div>

    </section>

    <!-- SECTION : PACKAGING -->
    <section id="sectionPackaging"
        class="flex flex-col items-center justify-start min-h-[calc(100vh-100px)] overflow-y-auto px-6 space-y-6 mb-32 mt-16">
        <h2 class="text-2xl font-bold text-text-color mb-4 mt-6">ðŸ“¦ Packs disponibles</h2>

        <ul class="w-full max-w-lg space-y-4">
            <!-- Province List Item Template -->
            <!-- Repeat for each province -->
            <li
                class="group bg-white rounded-2xl px-6 py-5 shadow-sm border border-gray-200 flex items-center justify-between hover:shadow-lg hover:bg-gray-50 transition">
                <div class="flex-1">
                    <h3 class="text-xl font-semibold text-gray-900 group-hover:text-primary-blue transition">
                        Antananarivo
                    </h3>
                    <p class="mt-1 text-sm text-gray-500">
                        <span
                            class="inline-block bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full font-medium">6000â€¯Ar</span>
                        <span class="ml-2 text-gray-400">/ 3 mois</span>
                    </p>
                </div>
                <button data-province="Antananarivo" class="downloadBtn flex items-center gap-3 bg-primary-blue text-dark px-6 py-2 text-sm font-medium rounded-lg shadow-md
           hover:bg-blue-600 active:scale-95 transition-transform" aria-label="TÃ©lÃ©charger le pack Antananarivo">
                    <i class="fas fa-download"></i>
                    TÃ©lÃ©charger
                </button>
            </li>
            <li
                class="group bg-white rounded-2xl px-6 py-5 shadow-sm border border-gray-200 flex items-center justify-between hover:shadow-lg hover:bg-gray-50 transition">
                <div class="flex-1">
                    <h3 class="text-xl font-semibold text-gray-900 group-hover:text-primary-blue transition">
                        Tamatave
                    </h3>
                    <p class="mt-1 text-sm text-gray-500">
                        <span
                            class="inline-block bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full font-medium">6000â€¯Ar</span>
                        <span class="ml-2 text-gray-400">/ 3 mois</span>
                    </p>
                </div>
                <button data-province="Antananarivo" class="downloadBtn flex items-center gap-3 bg-primary-blue text-dark px-6 py-2 text-sm font-medium rounded-lg shadow-md
           hover:bg-blue-600 active:scale-95 transition-transform" aria-label="TÃ©lÃ©charger le pack Antananarivo">
                    <i class="fas fa-download"></i>
                    TÃ©lÃ©charger
                </button>
            </li>
            <li
                class="group bg-white rounded-2xl px-6 py-5 shadow-sm border border-gray-200 flex items-center justify-between hover:shadow-lg hover:bg-gray-50 transition">
                <div class="flex-1">
                    <h3 class="text-xl font-semibold text-gray-900 group-hover:text-primary-blue transition">
                        Fianarantsoa
                    </h3>
                    <p class="mt-1 text-sm text-gray-500">
                        <span
                            class="inline-block bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full font-medium">6000â€¯Ar</span>
                        <span class="ml-2 text-gray-400">/ 3 mois</span>
                    </p>
                </div>
                <button data-province="Antananarivo" class="downloadBtn flex items-center gap-3 bg-primary-blue text-dark px-6 py-2 text-sm font-medium rounded-lg shadow-md
           hover:bg-blue-600 active:scale-95 transition-transform" aria-label="TÃ©lÃ©charger le pack Antananarivo">
                    <i class="fas fa-download"></i>
                    TÃ©lÃ©charger
                </button>
            </li>
            <li
                class="group bg-white rounded-2xl px-6 py-5 shadow-sm border border-gray-200 flex items-center justify-between hover:shadow-lg hover:bg-gray-50 transition">
                <div class="flex-1">
                    <h3 class="text-xl font-semibold text-gray-900 group-hover:text-primary-blue transition">
                        Toliara
                    </h3>
                    <p class="mt-1 text-sm text-gray-500">
                        <span
                            class="inline-block bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full font-medium">6000â€¯Ar</span>
                        <span class="ml-2 text-gray-400">/ 3 mois</span>
                    </p>
                </div>
                <button data-province="Antananarivo" class="downloadBtn flex items-center gap-3 bg-primary-blue text-dark px-6 py-2 text-sm font-medium rounded-lg shadow-md
           hover:bg-blue-600 active:scale-95 transition-transform" aria-label="TÃ©lÃ©charger le pack Antananarivo">
                    <i class="fas fa-download"></i>
                    TÃ©lÃ©charger
                </button>
            </li>
            <!-- /Province -->
            <!-- ... other list items ... -->
        </ul>
    </section>

    <!-- Updated payment modal with success toast -->
    <div id="paymentModal"
        class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 pointer-events-none transition-opacity">
        <div class="bg-white rounded-2xl p-6 w-80 shadow-lg">
            <h3 class="text-xl font-semibold mb-4">Valider le paiement</h3>
            <p id="modalProvince" class="text-gray-700 mb-6">Packs pour : <span class="font-medium"></span></p>
            <div class="space-y-4">
                <button id="payMvola"
                    class="w-full py-2 bg-green-400 text-black rounded-lg font-medium hover:brightness-105 transition">
                    Mvola
                </button>
                <button id="payOrange"
                    class="w-full py-2 bg-orange-500 text-white rounded-lg font-medium hover:brightness-105 transition">
                    Orange Money
                </button>
            </div>
            <button id="closeModal" class="mt-6 w-full py-2 text-sm text-gray-600 hover:underline">Annuler</button>
        </div>
    </div>

    <!-- Success Toast -->
    <div id="successToast"
        class="fixed inset-0 flex items-center justify-center z-50 bg-transparent pointer-events-none opacity-0 transition-opacity duration-300">
        <div class="bg-green-100 text-green-800 px-6 py-3 rounded-lg shadow-md flex items-center space-x-2">
            <i class="fas fa-check-circle text-2xl"></i>
            <span class="font-medium">Paiement rÃ©ussi !</span>
        </div>
    </div>
    </main>

    <!-- Footer -->
    <footer class="fixed bottom-4 left-1/2 -translate-x-1/2 w-[92%] max-w-md mx-auto
                bg-white rounded-full shadow-xl flex justify-around items-center px-4 py-2
                border border-gray-100">

        <button id="navHome" class="group flex items-center justify-center flex-1 py-2 px-3
                rounded-full transition-all duration-300
                text-gray-500 group-[.active]:bg-[#42FF1C] group-[.active]:text-white
                hover:bg-blue-50 hover:text-primary-blue">
            <i class="fas fa-house text-lg text-black  transition-all duration-300 group-[.active]:text-white"></i>

        </button>

        <button id="navMap" class="group flex items-center justify-center flex-1 py-2 px-3
                rounded-full transition-all duration-300
                text-gray-500 group-[.active]:bg- group-[.active]:text-white
                hover:bg-blue-50 hover:text-primary-blue">
            <i
                class="fas fa-map-location-dot text-black  text-lg transition-all duration-300 group-[.active]:text-white"></i>

        </button>

        <button id="navPackaging" class="group flex items-center justify-center flex-1 py-2 px-3
                rounded-full transition-all duration-300
                text-gray-500 group-[.active]:bg-primary-blue group-[.active]:text-white
                hover:bg-blue-50 hover:text-primary-blue">
            <i class="fas fa-box-open text-lg text-black  transition-all duration-300 group-[.active]:text-white"></i>
        </button>

    </footer>
    </div>

    <!-- InteractivitÃ© -->
    <script src="./main.js">
    </script>
    <script src="https://unpkg.com/@turf/turf@6.5.0/turf.min.js"></script>
    <script>
        document.getElementById('showRoute').addEventListener('click', function () {
            const image = document.getElementById('routeImage');
            image.src = 'safe.png';
        });
    </script>
    <script>
        // Open payment modal
        document.querySelectorAll('.downloadBtn').forEach(btn => {
            btn.addEventListener('click', () => {
                const province = btn.getAttribute('data-province');
                document.querySelector('#modalProvince span').textContent = province;
                const modal = document.getElementById('paymentModal');
                modal.classList.remove('opacity-0', 'pointer-events-none');
            });
        });

        // Close modal function
        function closeModal() {
            const modal = document.getElementById('paymentModal');
            modal.classList.add('opacity-0', 'pointer-events-none');
        }
        document.getElementById('closeModal').addEventListener('click', closeModal);

        // Show success toast for 5 seconds
        function showSuccessToast() {
            const toast = document.getElementById('successToast');
            // make it visible and allow pointer-events
            toast.classList.remove('opacity-0');
            toast.classList.remove('pointer-events-none');
            setTimeout(() => {
                toast.classList.add('opacity-0');
                toast.classList.add('pointer-events-none');
            }, 5000);
        }

        // Fake payment handlers
        document.getElementById('payMvola').addEventListener('click', () => {
            showSuccessToast();
            closeModal();
        });
        document.getElementById('payOrange').addEventListener('click', () => {
            showSuccessToast();
            closeModal();
        });
    </script>
    <script>
        // Wait for DOM
        document.addEventListener('DOMContentLoaded', () => {
            const loader = document.getElementById('initialLoader');
            const app = document.getElementById('appContent');
            // After 5 seconds, hide loader and show app
            setTimeout(() => {
                loader.classList.add('hidden');
                app.classList.remove('opacity-0', 'pointer-events-none');
            }, 2000);
        });
    </script>
</body>

</html>